<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ø±Ø± Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ù…Ø®ØµØµ</title>
    <style>
        * {margin: 0;padding: 0;box-sizing: border-box;}
        body {font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);min-height: 100vh;padding: 20px;}
        .container {background: white;border-radius: 20px;box-shadow: 0 20px 60px rgba(0,0,0,0.3);max-width: 1000px;width: 100%;margin: 0 auto;padding: 40px;}
        h1 {color: #2d3748;text-align: center;margin-bottom: 10px;font-size: 2.5em;}
        .subtitle {text-align: center;color: #667eea;margin-bottom: 40px;font-size: 1.1em;}
        .upload-section {text-align: center;margin-bottom: 30px;}
        .upload-box {border: 3px dashed #667eea;border-radius: 15px;padding: 40px;text-align: center;cursor: pointer;transition: all 0.3s;background: #f8f9fa;display: inline-block;min-width: 400px;}
        .upload-box:hover {background: #e9ecef;border-color: #764ba2;transform: translateY(-2px);}
        .upload-box.dragover {background: #dee2e6;border-color: #764ba2;}
        .upload-box.uploaded {border-color: #28a745;background: #d4edda;}
        .upload-icon {font-size: 4em;margin-bottom: 15px;}
        .upload-box h3 {color: #495057;margin-bottom: 10px;font-size: 1.5em;}
        .upload-box p {color: #6c757d;font-size: 1em;}
        input[type="file"] {display: none;}
        .editor-section {display: none;margin-top: 30px;}
        .editor-section.active {display: block;}
        .preview-container {position: relative;max-width: 600px;margin: 0 auto 30px;background: #f0f0f0;border-radius: 50%;overflow: hidden;aspect-ratio: 1;}
        #editorCanvas {display: block;width: 100%;height: 100%;cursor: move;touch-action: none;}
        .controls {background: #f8f9fa;padding: 25px;border-radius: 15px;margin-bottom: 20px;}
        .control-group {margin-bottom: 20px;}
        .control-group label {display: block;margin-bottom: 10px;color: #2d3748;font-weight: 600;font-size: 1.1em;}
        .control-row {display: flex;align-items: center;gap: 15px;}
        input[type="range"] {flex: 1;height: 8px;border-radius: 5px;background: #dee2e6;outline: none;-webkit-appearance: none;}
        input[type="range"]::-webkit-slider-thumb {-webkit-appearance: none;appearance: none;width: 20px;height: 20px;border-radius: 50%;background: #667eea;cursor: pointer;}
        input[type="range"]::-moz-range-thumb {width: 20px;height: 20px;border-radius: 50%;background: #667eea;cursor: pointer;border: none;}
        .value-display {min-width: 60px;text-align: center;font-weight: 600;color: #667eea;font-size: 1.1em;}
        .btn {background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);color: white;border: none;padding: 15px 40px;border-radius: 50px;font-size: 1.1em;cursor: pointer;transition: transform 0.2s;margin: 10px;font-weight: 600;}
        .btn:hover {transform: translateY(-2px);box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);}
        .btn-secondary {background: linear-gradient(135deg, #6c757d 0%, #495057 100%);}
        .buttons {text-align: center;margin-top: 20px;}
        .info {background: #e7f3ff;border-right: 4px solid #667eea;padding: 20px;border-radius: 10px;margin-top: 20px;color: #2d3748;}
        .info h4 {margin-bottom: 10px;color: #667eea;}
        .info ul {margin-right: 20px;line-height: 1.8;}
        @media (max-width: 768px) {.container {padding: 20px;}h1 {font-size: 1.8em;}.upload-box {min-width: 100%;}.preview-container {max-width: 100%;}}
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ Ù…Ø­Ø±Ø± Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ù…Ø®ØµØµ</h1>
        <div class="subtitle">Ø§Ø±ÙØ¹ ØµÙˆØ±ØªÙƒ ÙˆØ§Ø¶Ø¨Ø· Ù…ÙˆØ¶Ø¹Ù‡Ø§ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ø­ØªØ±Ø§ÙÙŠ</div>
        <div class="upload-section" id="uploadSection">
            <div class="upload-box" id="uploadArea">
                <div class="upload-icon">ğŸ“·</div>
                <h3>Ø§Ø±ÙØ¹ ØµÙˆØ±ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©</h3>
                <p>Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ø³Ø­Ø¨ ØµÙˆØ±ØªÙƒ</p>
                <input type="file" id="fileInput" accept="image/*">
            </div>
        </div>
        <div class="editor-section" id="editorSection">
            <div class="preview-container"><canvas id="editorCanvas"></canvas></div>
            <div class="controls">
                <div class="control-group"><label>ğŸ” Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø©</label><div class="control-row"><input type="range" id="scaleSlider" min="50" max="200" value="100" step="1"><span class="value-display" id="scaleValue">100%</span></div></div>
                <div class="control-group"><label>â†”ï¸ Ù…ÙˆØ¶Ø¹ Ø£ÙÙ‚ÙŠ</label><div class="control-row"><input type="range" id="xSlider" min="-200" max="200" value="0" step="1"><span class="value-display" id="xValue">0</span></div></div>
                <div class="control-group"><label>â†•ï¸ Ù…ÙˆØ¶Ø¹ Ø¹Ù…ÙˆØ¯ÙŠ</label><div class="control-row"><input type="range" id="ySlider" min="-200" max="200" value="0" step="1"><span class="value-display" id="yValue">0</span></div></div>
                <div class="control-group"><label>ğŸ”„ Ø¯ÙˆØ±Ø§Ù†</label><div class="control-row"><input type="range" id="rotationSlider" min="-180" max="180" value="0" step="1"><span class="value-display" id="rotationValue">0Â°</span></div></div>
            </div>
            <div class="buttons">
                <button class="btn" onclick="downloadImage()">ğŸ’¾ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©</button>
                <button class="btn" onclick="shareImage()">ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ©</button>
                <button class="btn btn-secondary" onclick="reset()">ğŸ”„ Ø±ÙØ¹ ØµÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
            </div>
        </div>
        <div class="info">
            <h4>ğŸ“ ÙƒÙŠÙ ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø¯Ø§Ø©:</h4>
            <ul>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 1:</strong> Ø§Ø±ÙØ¹ ØµÙˆØ±ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©</li>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 2:</strong> Ø§Ø¶Ø¨Ø· Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­ÙƒÙ…</li>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 3:</strong> Ø­Ø±Ùƒ Ø§Ù„ØµÙˆØ±Ø© Ø£ÙÙ‚ÙŠØ§Ù‹ ÙˆØ¹Ù…ÙˆØ¯ÙŠØ§Ù‹ Ù„Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø«Ø§Ù„ÙŠ</li>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 4:</strong> ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ø§Ù‹ ØªØ¯ÙˆÙŠØ± Ø§Ù„ØµÙˆØ±Ø© Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±</li>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 5:</strong> Ø´Ø§Ù‡Ø¯ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ù…Ø¨Ø§Ø´Ø±Ø© ÙˆØ§Ø¶ØºØ· ØªØ­Ù…ÙŠÙ„</li>
                <li><strong>Ù†ØµÙŠØ­Ø©:</strong> ÙŠÙ…ÙƒÙ†Ùƒ Ø³Ø­Ø¨ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ù„Ù…Ø§ÙˆØ³ Ø£Ùˆ Ø§Ù„Ø¥ØµØ¨Ø¹ Ù„ØªØ­Ø±ÙŠÙƒÙ‡Ø§ Ø¨Ø³Ù‡ÙˆÙ„Ø©</li>
            </ul>
        </div>
    </div>
    <script>
        // Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø·Ø§Ø± Ù‡Ù†Ø§ - Replace with your frame URL
        const FRAME_URL = 'https://raw.githubusercontent.com/mostafaezat-afk/nonoww/main/6_n.png';
        
        let userImage = null;
        let frameImage = null;
        let scale = 100;
        let posX = 0;
        let posY = 0;
        let rotation = 0;
        let isDragging = false;
        let startX, startY;

        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const uploadSection = document.getElementById('uploadSection');
        const editorSection = document.getElementById('editorSection');
        const canvas = document.getElementById('editorCanvas');
        const ctx = canvas.getContext('2d');

        const scaleSlider = document.getElementById('scaleSlider');
        const xSlider = document.getElementById('xSlider');
        const ySlider = document.getElementById('ySlider');
        const rotationSlider = document.getElementById('rotationSlider');

        const scaleValue = document.getElementById('scaleValue');
        const xValue = document.getElementById('xValue');
        const yValue = document.getElementById('yValue');
        const rotationValue = document.getElementById('rotationValue');

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø·Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        function loadFrame() {
            const img = new Image();
            img.crossOrigin = 'anonymous';
            img.onload = () => {
                frameImage = img;
            };
            img.onerror = () => {
                console.error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø·Ø§Ø± Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·');
            };
            img.src = FRAME_URL;
        }

        loadFrame();

        // Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        uploadArea.addEventListener('click', () => fileInput.click());
        
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                loadUserImage(e.target.files[0]);
            }
        });

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            if (e.dataTransfer.files.length > 0) {
                loadUserImage(e.dataTransfer.files[0]);
            }
        });

        function loadUserImage(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    userImage = img;
                    showEditor();
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function showEditor() {
            uploadSection.style.display = 'none';
            editorSection.classList.add('active');
            
            canvas.width = 600;
            canvas.height = 600;
            
            drawCanvas();
        }

        // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØªÙƒØ¨ÙŠØ± ÙˆØ§Ù„ØªØµØºÙŠØ±
        scaleSlider.addEventListener('input', (e) => {
            scale = parseInt(e.target.value);
            scaleValue.textContent = scale + '%';
            drawCanvas();
        });

        // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ‚ÙŠ
        xSlider.addEventListener('input', (e) => {
            posX = parseInt(e.target.value);
            xValue.textContent = posX;
            drawCanvas();
        });

        // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ
        ySlider.addEventListener('input', (e) => {
            posY = parseInt(e.target.value);
            yValue.textContent = posY;
            drawCanvas();
        });

        // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø¯ÙˆØ±Ø§Ù†
        rotationSlider.addEventListener('input', (e) => {
            rotation = parseInt(e.target.value);
            rotationValue.textContent = rotation + 'Â°';
            drawCanvas();
        });

        // Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³
        canvas.addEventListener('mousedown', startDrag);
        canvas.addEventListener('mousemove', drag);
        canvas.addEventListener('mouseup', endDrag);
        canvas.addEventListener('mouseleave', endDrag);

        // Ø¯Ø¹Ù… Ø§Ù„Ù„Ù…Ø³
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousedown', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousemove', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        });

        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            const mouseEvent = new MouseEvent('mouseup', {});
            canvas.dispatchEvent(mouseEvent);
        });

        function startDrag(e) {
            isDragging = true;
            startX = e.offsetX;
            startY = e.offsetY;
        }

        function drag(e) {
            if (!isDragging) return;
            
            const deltaX = e.offsetX - startX;
            const deltaY = e.offsetY - startY;
            
            posX += deltaX;
            posY += deltaY;
            
            xSlider.value = posX;
            ySlider.value = posY;
            xValue.textContent = posX;
            yValue.textContent = posY;
            
            startX = e.offsetX;
            startY = e.offsetY;
            
            drawCanvas();
        }

        function endDrag() {
            isDragging = false;
        }

        function drawCanvas() {
            if (!userImage) return;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            ctx.save();
            ctx.translate(centerX, centerY);
            ctx.rotate((rotation * Math.PI) / 180);
            ctx.translate(-centerX, -centerY);

            const scaleFactor = scale / 100;
            const imgScale = Math.max(canvas.width / userImage.width, canvas.height / userImage.height) * scaleFactor;
            const imgWidth = userImage.width * imgScale;
            const imgHeight = userImage.height * imgScale;
            const imgX = centerX - imgWidth / 2 + posX;
            const imgY = centerY - imgHeight / 2 + posY;

            ctx.drawImage(userImage, imgX, imgY, imgWidth, imgHeight);

            ctx.restore();

            if (frameImage) {
                ctx.drawImage(frameImage, 0, 0, canvas.width, canvas.height);
            }
        }

        function downloadImage() {
            const finalCanvas = document.createElement('canvas');
            const finalCtx = finalCanvas.getContext('2d');
            const size = 1200;
            
            finalCanvas.width = size;
            finalCanvas.height = size;

            const centerX = size / 2;
            const centerY = size / 2;

            finalCtx.save();
            finalCtx.translate(centerX, centerY);
            finalCtx.rotate((rotation * Math.PI) / 180);
            finalCtx.translate(-centerX, -centerY);

            const scaleFactor = scale / 100;
            const imgScale = Math.max(size / userImage.width, size / userImage.height) * scaleFactor;
            const imgWidth = userImage.width * imgScale;
            const imgHeight = userImage.height * imgScale;
            const imgX = centerX - imgWidth / 2 + (posX * 2);
            const imgY = centerY - imgHeight / 2 + (posY * 2);

            finalCtx.drawImage(userImage, imgX, imgY, imgWidth, imgHeight);
            finalCtx.restore();

            if (frameImage) {
                finalCtx.drawImage(frameImage, 0, 0, size, size);
            }

            const link = document.createElement('a');
            link.download = 'profile-with-frame.png';
            link.href = finalCanvas.toDataURL('image/png');
            link.click();
        }

        async function shareImage() {
            try {
                const finalCanvas = document.createElement('canvas');
                const finalCtx = finalCanvas.getContext('2d');
                const size = 1200;
                
                finalCanvas.width = size;
                finalCanvas.height = size;

                const centerX = size / 2;
                const centerY = size / 2;

                finalCtx.save();
                finalCtx.translate(centerX, centerY);
                finalCtx.rotate((rotation * Math.PI) / 180);
                finalCtx.translate(-centerX, -centerY);

                const scaleFactor = scale / 100;
                const imgScale = Math.max(size / userImage.width, size / userImage.height) * scaleFactor;
                const imgWidth = userImage.width * imgScale;
                const imgHeight = userImage.height * imgScale;
                const imgX = centerX - imgWidth / 2 + (posX * 2);
                const imgY = centerY - imgHeight / 2 + (posY * 2);

                finalCtx.drawImage(userImage, imgX, imgY, imgWidth, imgHeight);
                finalCtx.restore();

                if (frameImage) {
                    finalCtx.drawImage(frameImage, 0, 0, size, size);
                }

                const blob = await new Promise(resolve => finalCanvas.toBlob(resolve, 'image/png'));
                const file = new File([blob], 'profile-frame.png', { type: 'image/png' });
                
                if (navigator.share && navigator.canShare({ files: [file] })) {
                    await navigator.share({
                        files: [file],
                        title: 'ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„Ø®Ø§ØµØ© Ø¨ÙŠ'
                    });
                } else {
                    downloadImage();
                    alert('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ù…Ø´Ø§Ø±ÙƒØªÙ‡Ø§');
                }
            } catch (error) {
                downloadImage();
            }
        }

        function reset() {
            userImage = null;
            scale = 100;
            posX = 0;
            posY = 0;
            rotation = 0;
            
            scaleSlider.value = 100;
            xSlider.value = 0;
            ySlider.value = 0;
            rotationSlider.value = 0;
            
            scaleValue.textContent = '100%';
            xValue.textContent = '0';
            yValue.textContent = '0';
            rotationValue.textContent = '0Â°';
            
            fileInput.value = '';
            editorSection.classList.remove('active');
            uploadSection.style.display = 'block';
        }
    </script>
</body>
</html>
