<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ù…ÙˆÙ„Ø¯ Ø¨Ø·Ø§Ù‚Ø§Øª Ø¯Ø¹Ù… Ø§Ù„Ù…Ø±Ø´Ø­ÙŠÙ†</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Cairo', sans-serif; background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%); min-height: 100vh; padding: 0; color: #333; user-select: none; touch-action: manipulation; }
        .container { max-width: 100%; margin: 0 auto; background: white; min-height: 100vh; }
        .header { background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%); padding: 20px; text-align: center; color: white; position: relative; overflow: hidden; }
        .header::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); animation: shimmer 3s infinite; }
        @keyframes shimmer { 0%, 100% { transform: translate(0, 0); } 50% { transform: translate(10%, 10%); }}
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; }}
        .header h1 { font-size: 1.5em; margin-bottom: 8px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); position: relative; z-index: 1; }
        .header p { font-size: 0.9em; opacity: 0.95; position: relative; z-index: 1; }
        .floating-preview { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 33vh; z-index: 999; background: linear-gradient(135deg, #e3e8f0 0%, #c5d3e8 100%); box-shadow: 0 5px 20px rgba(0,0,0,0.3); padding: 10px; display: flex; align-items: center; justify-content: center; }
        .editor-layout { background: #f8f9fa; }
        .canvas-container { background: linear-gradient(135deg, #e3e8f0 0%, #c5d3e8 100%); padding: 20px; display: flex; align-items: center; justify-content: center; min-height: 70vh; }
        #canvas { max-width: 90%; max-height: 90%; width: auto; height: auto; display: block; cursor: move; box-shadow: 0 15px 50px rgba(0,0,0,0.3); border-radius: 15px; background: white; }
        .tabs-container { padding: 20px; background: white; }
        .tabs { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 20px; background: #f8f9fa; padding: 8px; border-radius: 15px; }
        .tab { padding: 10px 8px; border: none; background: transparent; border-radius: 10px; font-size: 0.8em; font-weight: 600; cursor: pointer; transition: all 0.3s; color: #6c757d; font-family: 'Cairo', sans-serif; text-align: center;}
        .tab.active { background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%); color: white; box-shadow: 0 3px 10px rgba(231, 76, 60, 0.3); }
        .tab-content { display: none; background: white; padding: 15px; border-radius: 15px; min-height: 400px; }
        .tab-content.active { display: block; }
        .input-group { margin-bottom: 20px; background: white; padding: 15px; border-radius: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .input-group label { display: block; font-weight: 700; margin-bottom: 10px; color: #495057; font-size: 1em; }
        .input-group input[type="text"], .input-group textarea { width: 100%; padding: 12px 15px; border: 2px solid #e9ecef; border-radius: 10px; font-size: 1em; font-family: 'Cairo', sans-serif; transition: all 0.3s; background: white; }
        .input-group input[type="text"]:focus, .input-group textarea:focus { outline: none; border-color: #e74c3c; box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.1); transform: translateY(-2px); }
        .input-group textarea { resize: vertical; min-height: 80px; }
        .upload-box { border: 3px dashed #e74c3c; background: white; padding: 40px 20px; text-align: center; border-radius: 20px; cursor: pointer; transition: all 0.3s; margin-bottom: 20px; }
        .upload-box:hover, .upload-box:active { border-color: #c0392b; background: #fff5f5; transform: scale(1.02); }
        .upload-icon { font-size: 60px; margin-bottom: 15px; }
        .upload-text { font-size: 1.1em; font-weight: 600; color: #e74c3c; margin-bottom: 8px; }
        .frames-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        .frame-card { cursor: pointer; padding: 10px; border: 3px solid transparent; border-radius: 15px; background: #f8f9fa; transition: all 0.3s; position: relative; text-align: center; }
        .frame-card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.15); }
        .frame-card.active { border-color: #e74c3c; background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%); box-shadow: 0 5px 20px rgba(231, 76, 60, 0.3); }
        .frame-card img { width: 100%; height: 120px; object-fit: cover; border-radius: 10px; margin-bottom: 8px; }
        .frame-name { font-size: 0.9em; font-weight: 600; color: #495057; }
        .frame-check { position: absolute; top: 15px; left: 15px; width: 25px; height: 25px; border-radius: 50%; background: #e74c3c; color: white; display: none; align-items: center; justify-content: center; font-size: 14px; box-shadow: 0 2px 8px rgba(0,0,0,0.3); }
        .frame-card.active .frame-check { display: flex; }
        .control-group { margin-bottom: 20px; }
        .control-group label { display: flex; justify-content: space-between; font-weight: 600; margin-bottom: 10px; color: #495057; font-size: 0.95em; }
        .control-value { background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%); color: white; padding: 2px 10px; border-radius: 12px; font-size: 0.85em; }
        input[type=range] { width: 100%; height: 8px; background: #e9ecef; border-radius: 10px; outline: none; -webkit-appearance: none; cursor: pointer; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 24px; height: 24px; background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%); border-radius: 50%; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.2); transition: all 0.2s; }
        input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.2); }
        .color-options { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
        .color-option { width: 50px; height: 50px; border-radius: 12px; cursor: pointer; border: 3px solid transparent; transition: all 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.15); }
        .color-option:hover { transform: scale(1.1); }
        .color-option.active { border-color: #e74c3c; box-shadow: 0 0 0 4px rgba(231, 76, 60, 0.2); }
        .button-section { padding: 20px; background: #f8f9fa; position: sticky; bottom: 0; box-shadow: 0 -2px 10px rgba(0,0,0,0.1); z-index: 100; }
        .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .btn { padding: 16px; border: none; border-radius: 15px; font-size: 1em; font-weight: 700; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 8px; font-family: 'Cairo', sans-serif; }
        .btn:active { transform: scale(0.95); }
        .btn-primary { background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%); color: white; box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4); }
        .btn-secondary { background: white; color: #e74c3c; border: 2px solid #e74c3c; }
        .loading { text-align: center; padding: 20px; color: #6c757d; }
        .fb-alert { display: none; background: #fff3cd; border: 2px solid #ffc107; border-radius: 10px; padding: 12px; margin-bottom: 15px; text-align: center; color: #856404; font-size: 0.9em; }
        .fb-alert.show { display: block; }
        .guide-section { background: #f8f9fa; padding: 30px 20px; border-top: 3px solid #e74c3c; }
        .guide-title { text-align: center; font-size: 1.3em; font-weight: 700; color: #c0392b; margin-bottom: 20px; }
        .guide-steps { display: grid; gap: 15px; max-width: 800px; margin: 0 auto; }
        .guide-step { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); display: flex; gap: 15px; align-items: start; }
        .guide-number { min-width: 35px; height: 35px; background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.1em; }
        .guide-content h3 { font-size: 1em; color: #495057; margin-bottom: 5px; }
        .guide-content p { font-size: 0.9em; color: #6c757d; line-height: 1.5; }
        @media (min-width: 1024px) { 
            .editor-layout { display: grid; grid-template-columns: 1fr 450px; gap: 0; min-height: calc(100vh - 80px); }
            .canvas-container { display: flex !important; }
            .tabs-container { background: white; border-left: none; overflow-y: auto; max-height: calc(100vh - 80px); }
            .floating-preview { display: none !important; }
            .tabs { grid-template-columns: repeat(5, 1fr); }
            .guide-section { padding: 40px; }
        }
        @media (max-width: 1023px) { 
            .editor-layout { display: block; }
            .canvas-container { display: none !important; }
            .floating-preview { display: flex !important; }
            .tabs-container { margin-top: 33vh; padding-top: 20px; padding-bottom: 120px; }
        }
        @media (max-width: 480px) { .header h1 { font-size: 1.3em; }}
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>ğŸ—³ï¸ Ù…ÙˆÙ„Ø¯ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ø§Ù†ØªØ®Ø§Ø¨ÙŠ</h1>
        <p>ØµÙ…Ù… Ø¨Ø·Ø§Ù‚Ø© Ø¯Ø¹Ù… Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù„Ù„Ù…Ø±Ø´Ø­</p>
    </div>
    <div class="floating-preview" id="floatingPreview"><canvas id="canvas"></canvas></div>
    <div class="editor-layout" id="editorLayout">
        <div class="canvas-container" id="canvasContainer"></div>
        <div class="tabs-container">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('data')">ğŸ“ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                <button class="tab" onclick="switchTab('image')">ğŸ“¸ Ø§Ù„ØµÙˆØ±Ø©</button>
                <button class="tab" onclick="switchTab('frame')">ğŸ–¼ï¸ Ø§Ù„Ø¥Ø·Ø§Ø±</button>
                <button class="tab" onclick="switchTab('text')">âœï¸ Ø§Ù„Ù†Øµ</button>
                <button class="tab" onclick="switchTab('colors')">ğŸ¨ Ø§Ù„Ø£Ù„ÙˆØ§Ù†</button>
            </div>
            <div id="dataTab" class="tab-content active">
                <div class="input-group">
                    <label>ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…</label>
                    <input type="text" id="nameInput" placeholder="Ù…Ø«Ø§Ù„: Ù…ØµØ·ÙÙ‰ Ø¹Ø²Øª Ù‡Ø§Ø±ÙˆÙ†">
                </div>
                <div class="input-group">
                    <label>ğŸ’¼ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø£Ùˆ Ø§Ù„Ù„Ù‚Ø¨</label>
                    <textarea id="jobInput" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø­Ø§Ù…Ù‰ Ø¨Ø§Ù„Ø§Ø³ØªÙ†Ø§Ù Ø§Ù„Ø¹Ø§Ù„Ù‰ ÙˆÙ…Ø¬Ù„Ø³ Ø§Ù„Ø¯ÙˆÙ„Ø©"></textarea>
                </div>
                <div class="control-group">
                    <label style="margin-bottom: 10px;"><span>ğŸ“ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙˆØ¸ÙŠÙØ©</span></label>
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; background: #f8f9fa; padding: 10px; border-radius: 10px;">
                        <input type="checkbox" id="showJob" checked style="width: 20px; height: 20px; cursor: pointer;">
                        <span style="font-weight: 500;">Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ¸ÙŠÙØ© ÙÙŠ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</span>
                    </label>
                </div>
            </div>
            <div id="imageTab" class="tab-content">
                <div class="upload-box" onclick="document.getElementById('fileInput').click()">
                    <div class="upload-icon">ğŸ“¸</div>
                    <div class="upload-text">Ø§Ø¶ØºØ· Ù„Ø±ÙØ¹ ØµÙˆØ±ØªÙƒ</div>
                    <input type="file" id="fileInput" accept="image/*" style="display: none;">
                </div>
                <div class="control-group">
                    <label><span>ğŸ” Ø§Ù„ØªÙƒØ¨ÙŠØ± ÙˆØ§Ù„ØªØµØºÙŠØ±</span><span class="control-value" id="scaleValue">50%</span></label>
                    <input type="range" id="scale" min="10" max="200" value="50">
                </div>
                <div class="control-group">
                    <label><span>â†”ï¸ Ø§Ù„ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø£ÙÙ‚ÙŠ</span><span class="control-value" id="posXValue">0</span></label>
                    <input type="range" id="posX" min="-500" max="500" value="0">
                </div>
                <div class="control-group">
                    <label><span>â†•ï¸ Ø§Ù„ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ</span><span class="control-value" id="posYValue">0</span></label>
                    <input type="range" id="posY" min="-500" max="500" value="0">
                </div>
                <div class="control-group">
                    <label><span>âœ¨ ÙÙ„ØªØ± Ø§Ù„ØªØ¬Ù…ÙŠÙ„</span><span class="control-value" id="beautyFilterValue">0%</span></label>
                    <input type="range" id="beautyFilter" min="0" max="100" value="0">
                    <p style="font-size: 0.85em; color: #6c757d; margin-top: 8px;">ÙŠØ¬Ø¹Ù„ Ø§Ù„Ø¨Ø´Ø±Ø© Ø£ÙƒØ«Ø± Ù†Ø¹ÙˆÙ…Ø© ÙˆØ¥Ø´Ø±Ø§Ù‚Ø§Ù‹</p>
                </div>
            </div>
            <div id="frameTab" class="tab-content">
                <div class="loading" id="framesLoading">â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØµØ§Ù…ÙŠÙ…...</div>
                <div class="frames-grid" id="framesGrid"></div>
            </div>
            <div id="textTab" class="tab-content">
                <div class="control-group">
                    <label><span>ğŸ“ Ø­Ø¬Ù… Ø®Ø· Ø§Ù„Ø§Ø³Ù…</span><span class="control-value" id="nameSizeValue">45</span></label>
                    <input type="range" id="nameSize" min="20" max="80" value="45">
                </div>
                <div class="control-group">
                    <label><span>â†”ï¸ Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø³Ù… Ø£ÙÙ‚ÙŠØ§Ù‹</span><span class="control-value" id="namePosXValue">270</span></label>
                    <input type="range" id="namePosX" min="100" max="980" value="270">
                </div>
                <div class="control-group">
                    <label><span>â†•ï¸ Ø§Ù„Ù…Ø³Ø§ÙØ© Ù…Ù† Ø§Ù„Ø£Ø³ÙÙ„</span><span class="control-value" id="nameOffsetYValue">270</span></label>
                    <input type="range" id="nameOffsetY" min="100" max="700" value="270">
                    <p style="font-size: 0.85em; color: #6c757d; margin-top: 8px;">ğŸ’¡ Ø§Ù„Ù†Øµ ÙÙŠ Ø§Ù„Ø±Ø¨Ø¹ Ø§Ù„Ø³ÙÙ„ÙŠ Ø§Ù„Ø£ÙŠØ³Ø±</p>
                </div>
                <div class="control-group">
                    <label><span>ğŸ“ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ÙˆØ¸ÙŠÙØ©</span><span class="control-value" id="jobSpacingValue">15</span></label>
                    <input type="range" id="jobSpacing" min="5" max="50" value="15">
                </div>
            </div>
            <div id="colorsTab" class="tab-content">
                <div class="control-group">
                    <label>ğŸ¨ Ù„ÙˆÙ† Ø§Ù„Ø§Ø³Ù…</label>
                    <div class="color-options" id="nameColorOptions"></div>
                </div>
                <div class="control-group">
                    <label>ğŸ¨ Ù„ÙˆÙ† Ø§Ù„ÙˆØ¸ÙŠÙØ©</label>
                    <div class="color-options" id="jobColorOptions"></div>
                </div>
                <div class="control-group">
                    <button class="btn btn-secondary" onclick="resetControls()" style="width: 100%;"><span>ğŸ”„</span><span>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span></button>
                </div>
            </div>
            <div class="button-section">
                <div class="fb-alert" id="fbAlert">âš ï¸ Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ³ØªØ®Ø¯Ù… Ù…ØªØµÙØ­ ÙÙŠØ³Ø¨ÙˆÙƒØŒ Ø§Ø¶ØºØ· Ø§Ù„Ø²Ø± Ù„ÙØªØ­ ØµÙØ­Ø© Ø§Ù„Ø­ÙØ¸</div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="downloadImage()"><span>ğŸ’¾</span><span>Ø­ÙØ¸ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</span></button>
                    <button class="btn btn-secondary" onclick="openInBrowser()"><span>ğŸŒ</span><span>ÙØªØ­ Ø®Ø§Ø±Ø¬ÙŠØ§Ù‹</span></button>
                </div>
                <button class="btn btn-secondary" onclick="location.reload()" style="width: 100%; margin-top: 12px;"><span>ğŸ”„</span><span>Ø¨Ø·Ø§Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©</span></button>
            </div>
        </div>
    </div>
    <div class="guide-section">
        <h2 class="guide-title">ğŸ“– ÙƒÙŠÙÙŠØ© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ø¯Ø§Ø©</h2>
        <div class="guide-steps">
            <div class="guide-step">
                <div class="guide-number">1</div>
                <div class="guide-content">
                    <h3>ğŸ“ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
                    <p>Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ÙˆØ¸ÙŠÙØ© ÙÙŠ ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª". ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª.</p>
                </div>
            </div>
            <div class="guide-step">
                <div class="guide-number">2</div>
                <div class="guide-content">
                    <h3>ğŸ“¸ Ø§Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©</h3>
                    <p>Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„ØµÙˆØ±Ø©" ÙˆØ§Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ù…Ø±Ø´Ø­. Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªÙƒØ¨ÙŠØ± ÙˆØ§Ù„ØªØ­Ø±ÙŠÙƒ Ù„Ø¶Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¥Ø·Ø§Ø±.</p>
                </div>
            </div>
            <div class="guide-step">
                <div class="guide-number">3</div>
                <div class="guide-content">
                    <h3>ğŸ–¼ï¸ Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø·Ø§Ø±</h3>
                    <p>Ù…Ù† ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ø¥Ø·Ø§Ø±"ØŒ Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ø¨Ø·Ø§Ù‚ØªÙƒ Ù…Ù† Ø§Ù„ØªØµØ§Ù…ÙŠÙ… Ø§Ù„Ù…ØªØ§Ø­Ø©.</p>
                </div>
            </div>
            <div class="guide-step">
                <div class="guide-number">4</div>
                <div class="guide-content">
                    <h3>âœï¸ Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ù†Øµ</h3>
                    <p>ÙÙŠ ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ù†Øµ"ØŒ ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ø®Ø· ÙˆÙ…ÙˆØ¶Ø¹ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„ÙˆØ¸ÙŠÙØ© Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©.</p>
                </div>
            </div>
            <div class="guide-step">
                <div class="guide-number">5</div>
                <div class="guide-content">
                    <h3>ğŸ¨ Ø§Ø®ØªØ± Ø§Ù„Ø£Ù„ÙˆØ§Ù†</h3>
                    <p>Ù…Ù† ØªØ¨ÙˆÙŠØ¨ "Ø§Ù„Ø£Ù„ÙˆØ§Ù†"ØŒ Ø§Ø®ØªØ± Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø§Ø³Ù… ÙˆØ§Ù„ÙˆØ¸ÙŠÙØ©. ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ø§Ù‹ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª.</p>
                </div>
            </div>
            <div class="guide-step">
                <div class="guide-number">6</div>
                <div class="guide-content">
                    <h3>ğŸ’¾ Ø§Ø­ÙØ¸ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</h3>
                    <p>Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ØŒ Ø§Ø¶ØºØ· "Ø­ÙØ¸ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©". Ø¥Ø°Ø§ ÙƒÙ†Øª ÙÙŠ Ù…ØªØµÙØ­ ÙÙŠØ³Ø¨ÙˆÙƒØŒ Ø³ØªØ¸Ù‡Ø± Ø±Ø³Ø§Ù„Ø© Ù„ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ù…ØªØµÙØ­ Ø¢Ø®Ø±.</p>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbyhn2O-hbv-WoPy2oZkBOjndX1RN46MxFxPJCu2wE83kHzxjYJxk8lCGEyEf5OOuThO/exec';
    const textColors = [{color:'#8B1538',name:'Ø¹Ù†Ø§Ø¨ÙŠ'},{color:'#FFFFFF',name:'Ø£Ø¨ÙŠØ¶'},{color:'#000000',name:'Ø£Ø³ÙˆØ¯'},{color:'#c0392b',name:'Ø£Ø­Ù…Ø±'},{color:'#FFD700',name:'Ø°Ù‡Ø¨ÙŠ'},{color:'#27ae60',name:'Ø£Ø®Ø¶Ø±'},{color:'#2980b9',name:'Ø£Ø²Ø±Ù‚'}];
    const canvas = document.getElementById('canvas'), ctx = canvas.getContext('2d');
    canvas.width = 1080; canvas.height = 1080;
    let userImg = null, frameImg = new Image(), currentFrame = null, frames = [], userName = '', userJob = '';
    frameImg.crossOrigin = "anonymous";
    let settings = {scale: 50, x: 0, y: 0, beautyFilter: 0, nameSize: 45, namePosX: 270, nameOffsetY: 270, jobSpacing: 15, nameColor: '#8B1538', jobColor: '#000000', showJob: true};
    
    function isFacebookBrowser() {
        const ua = navigator.userAgent || navigator.vendor || window.opera;
        return (ua.indexOf("FBAN") > -1) || (ua.indexOf("FBAV") > -1) || (ua.indexOf("Instagram") > -1);
    }
    
    if (isFacebookBrowser()) document.getElementById('fbAlert').classList.add('show');
    
    function openInBrowser() {
        const currentUrl = window.location.href;
        if (navigator.userAgent.match(/Android/i)) {
            window.location.href = `intent://${currentUrl.replace(/^https?:\/\//, '')}#Intent;scheme=https;package=com.android.chrome;end`;
        } else if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) {
            copyToClipboard(currentUrl);
            alert('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·!\n\nØ§Ù„ØµÙ‚ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ù…ØªØµÙØ­ Ø³ÙØ§Ø±ÙŠ Ø£Ùˆ ÙƒØ±ÙˆÙ… Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø¯ÙˆÙ† Ù…Ø´Ø§ÙƒÙ„.');
        } else {
            alert('ğŸ“± Ø§ÙØªØ­ Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ù…ØªØµÙØ­ Ø®Ø§Ø±Ø¬ÙŠ (Chrome Ø£Ùˆ Safari) Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.');
        }
    }
    
    function copyToClipboard(text) {
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(text);
        } else {
            const textarea = document.createElement('textarea');
            textarea.value = text; textarea.style.position = 'fixed'; textarea.style.opacity = '0';
            document.body.appendChild(textarea); textarea.select(); document.execCommand('copy');
            document.body.removeChild(textarea);
        }
    }
    
    function downloadImage() {
        if (isFacebookBrowser()) {
            showFacebookWarning();
        } else {
            const link = document.createElement('a');
            link.download = 'election-support-card.png';
            link.href = canvas.toDataURL('image/png', 1.0);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    }
    
    function showFacebookWarning() {
        const overlay = document.createElement('div');
        overlay.style.cssText = `
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.7); z-index: 9999; 
            display: flex; align-items: center; justify-content: center;
            animation: fadeIn 0.3s;
        `;
        
        overlay.innerHTML = `
            <div style="background: white; border-radius: 20px; padding: 30px; max-width: 90%; max-width: 400px; text-align: center; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                <div style="font-size: 4em; margin-bottom: 15px;">âš ï¸</div>
                <h2 style="color: #c0392b; font-size: 1.4em; margin-bottom: 15px; font-family: 'Cairo', sans-serif;">ØªÙ†Ø¨ÙŠÙ‡ Ù…ØªØµÙØ­ ÙÙŠØ³Ø¨ÙˆÙƒ</h2>
                <p style="color: #495057; line-height: 1.8; margin-bottom: 20px; font-family: 'Cairo', sans-serif;">
                    Ù…ØªØµÙØ­ ÙÙŠØ³Ø¨ÙˆÙƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
                </p>
                <div style="background: #fff5f5; padding: 15px; border-radius: 10px; margin-bottom: 20px; border-right: 4px solid #e74c3c; text-align: right;">
                    <p style="font-weight: 600; margin-bottom: 10px; color: #c0392b;">Ù„Ù„Ø­ÙØ¸:</p>
                    <ol style="color: #495057; line-height: 2;">
                        <li>Ø§Ø¶ØºØ· "ÙØªØ­ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­" Ø£Ø¯Ù†Ø§Ù‡</li>
                        <li>Ø§Ø¶ØºØ· "Ø­ÙØ¸ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©" Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</li>
                    </ol>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <button onclick="document.body.removeChild(this.closest('div').parentElement)" 
                        style="padding: 12px; border: 2px solid #e74c3c; background: white; color: #e74c3c; border-radius: 10px; font-weight: 700; cursor: pointer; font-family: 'Cairo', sans-serif;">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button onclick="openInBrowser(); document.body.removeChild(this.closest('div').parentElement);" 
                        style="padding: 12px; border: none; background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%); color: white; border-radius: 10px; font-weight: 700; cursor: pointer; font-family: 'Cairo', sans-serif;">
                        ÙØªØ­ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­
                    </button>
                </div>
            </div>
        `;
        
        document.body.appendChild(overlay);
    }
    
    async function loadSettingsFromAPI() {
        try {
            const response = await fetch(`${API_URL}?action=getSettings`), data = await response.json();
            if (data.success && data.settings) {
                settings = { ...settings, ...data.settings };
                updateControlsFromSettings();
                console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ù† Sheets:', settings);
            }
        } catch (error) { console.error('âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:', error); }
    }
    
    function updateControlsFromSettings() {
        document.getElementById('scale').value = settings.scale;
        document.getElementById('posX').value = settings.x;
        document.getElementById('posY').value = settings.y;
        document.getElementById('beautyFilter').value = settings.beautyFilter;
        document.getElementById('nameSize').value = settings.nameSize;
        document.getElementById('namePosX').value = settings.namePosX;
        document.getElementById('nameOffsetY').value = settings.nameOffsetY;
        document.getElementById('jobSpacing').value = settings.jobSpacing;
        document.getElementById('showJob').checked = settings.showJob;
        document.getElementById('scaleValue').textContent = settings.scale + '%';
        document.getElementById('posXValue').textContent = settings.x;
        document.getElementById('posYValue').textContent = settings.y;
        document.getElementById('beautyFilterValue').textContent = settings.beautyFilter + '%';
        document.getElementById('nameSizeValue').textContent = settings.nameSize;
        document.getElementById('namePosXValue').textContent = settings.namePosX;
        document.getElementById('nameOffsetYValue').textContent = settings.nameOffsetY;
        document.getElementById('jobSpacingValue').textContent = settings.jobSpacing;
    }
    
    function moveCanvas() {
        const canvasContainer = document.getElementById('canvasContainer'), floatingPreview = document.getElementById('floatingPreview');
        if (window.innerWidth >= 1024) {
            if (!canvasContainer.contains(canvas)) canvasContainer.appendChild(canvas);
        } else {
            if (!floatingPreview.contains(canvas)) floatingPreview.appendChild(canvas);
        }
    }
    
    async function loadFrames() {
        const grid = document.getElementById('framesGrid'), loading = document.getElementById('framesLoading');
        try {
            const response = await fetch(`${API_URL}?action=getFrames`), data = await response.json();
            if (data.success && data.frames) frames = data.frames;
        } catch (error) { console.error('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª:', error); }
        loading.style.display = 'none'; grid.innerHTML = '';
        frames.forEach((frame, index) => {
            const card = document.createElement('div');
            card.className = `frame-card ${index === 0 ? 'active' : ''}`;
            card.innerHTML = `<div class="frame-check">âœ“</div><img src="${frame.thumb}" alt="${frame.name}"><div class="frame-name">${frame.name}</div>`;
            card.onclick = () => selectFrame(frame, card);
            grid.appendChild(card);
        });
        if (frames.length > 0) {
            currentFrame = frames[0]; frameImg.src = frames[0].url;
            frameImg.onload = () => { console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø·Ø§Ø±'); draw(); };
        }
    }
    
    function selectFrame(frame, cardElement) {
        document.querySelectorAll('.frame-card').forEach(c => c.classList.remove('active'));
        cardElement.classList.add('active'); currentFrame = frame; frameImg.src = frame.url;
        frameImg.onload = () => { console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø·Ø§Ø±:', frame.name); draw(); };
    }
    
    function loadColors() {
        const nameColorContainer = document.getElementById('nameColorOptions');
        nameColorContainer.innerHTML = '';
        textColors.forEach((tc) => {
            const option = document.createElement('div');
            option.className = `color-option ${tc.color === settings.nameColor ? 'active' : ''}`;
            option.style.background = tc.color;
            if (tc.color === '#FFFFFF') option.style.border = '2px solid #dee2e6';
            option.title = tc.name;
            option.onclick = () => {
                nameColorContainer.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
                option.classList.add('active'); settings.nameColor = tc.color; draw();
            };
            nameColorContainer.appendChild(option);
        });
        const jobColorContainer = document.getElementById('jobColorOptions');
        jobColorContainer.innerHTML = '';
        textColors.forEach((tc) => {
            const option = document.createElement('div');
            option.className = `color-option ${tc.color === settings.jobColor ? 'active' : ''}`;
            option.style.background = tc.color;
            if (tc.color === '#FFFFFF') option.style.border = '2px solid #dee2e6';
            option.title = tc.name;
            option.onclick = () => {
                jobColorContainer.querySelectorAll('.color-option').forEach(o => o.classList.remove('active'));
                option.classList.add('active'); settings.jobColor = tc.color; draw();
            };
            jobColorContainer.appendChild(option);
        });
    }
    
    document.getElementById('fileInput').onchange = function(e) {
        if (e.target.files && e.target.files[0]) {
            const reader = new FileReader();
            reader.onload = function(event) {
                userImg = new Image();
                userImg.onload = function() {
                    document.querySelector('.upload-text').textContent = 'âœ“ ØªÙ… Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©';
                    document.querySelector('.upload-box').style.borderColor = '#27ae60'; draw();
                };
                userImg.src = event.target.result;
            };
            reader.readAsDataURL(e.target.files[0]);
        }
    };
    
    document.getElementById('nameInput').oninput = () => { userName = document.getElementById('nameInput').value.trim(); draw(); };
    document.getElementById('jobInput').oninput = () => { userJob = document.getElementById('jobInput').value.trim(); draw(); };
    
    function draw() {
        ctx.clearRect(0, 0, 1080, 1080);
        if (userImg) {
            ctx.save();
            if (settings.beautyFilter > 0) ctx.filter = `blur(${settings.beautyFilter * 0.02}px) brightness(${1 + settings.beautyFilter * 0.001})`;
            const scaleFactor = settings.scale / 100, imgW = 1080 * scaleFactor, imgH = 1080 * scaleFactor, centerX = 540, centerY = 540;
            ctx.drawImage(userImg, centerX - imgW/2 + settings.x, centerY - imgH/2 + settings.y, imgW, imgH);
            ctx.restore();
        }
        if (frameImg.complete && frameImg.naturalWidth > 0) ctx.drawImage(frameImg, 0, 0, 1080, 1080);
        if (userName) {
            const nameY = 1080 - settings.nameOffsetY;
            ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
            ctx.font = `bold ${settings.nameSize}px Cairo, Arial`;
            ctx.strokeStyle = '#fff'; ctx.lineWidth = 4;
            ctx.strokeText(userName, settings.namePosX, nameY);
            ctx.fillStyle = settings.nameColor;
            ctx.fillText(userName, settings.namePosX, nameY);
            if (settings.showJob && userJob) {
                const jobY = nameY + settings.nameSize + settings.jobSpacing;
                ctx.font = `26px Cairo, Arial`;
                ctx.fillStyle = settings.jobColor;
                ctx.fillText(userJob, settings.namePosX, jobY);
            }
        }
    }
    
    function switchTab(tabName) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        event.target.classList.add('active');
        document.getElementById(tabName + 'Tab').classList.add('active');
    }
    
    document.getElementById('scale').oninput = (e) => { settings.scale = parseInt(e.target.value); document.getElementById('scaleValue').textContent = settings.scale + '%'; draw(); };
    document.getElementById('posX').oninput = (e) => { settings.x = parseInt(e.target.value); document.getElementById('posXValue').textContent = settings.x; draw(); };
    document.getElementById('posY').oninput = (e) => { settings.y = parseInt(e.target.value); document.getElementById('posYValue').textContent = settings.y; draw(); };
    document.getElementById('beautyFilter').oninput = (e) => { settings.beautyFilter = parseInt(e.target.value); document.getElementById('beautyFilterValue').textContent = settings.beautyFilter + '%'; draw(); };
    document.getElementById('nameSize').oninput = (e) => { settings.nameSize = parseInt(e.target.value); document.getElementById('nameSizeValue').textContent = settings.nameSize; draw(); };
    document.getElementById('namePosX').oninput = (e) => { settings.namePosX = parseInt(e.target.value); document.getElementById('namePosXValue').textContent = settings.namePosX; draw(); };
    document.getElementById('nameOffsetY').oninput = (e) => { settings.nameOffsetY = parseInt(e.target.value); document.getElementById('nameOffsetYValue').textContent = settings.nameOffsetY; draw(); };
    document.getElementById('jobSpacing').oninput = (e) => { settings.jobSpacing = parseInt(e.target.value); document.getElementById('jobSpacingValue').textContent = settings.jobSpacing; draw(); };
    document.getElementById('showJob').onchange = (e) => { settings.showJob = e.target.checked; draw(); };
    
    function resetControls() {
        settings = {scale:50,x:0,y:0,beautyFilter:0,nameSize:45,namePosX:270,nameOffsetY:270,jobSpacing:15,nameColor:'#8B1538',jobColor:'#000000',showJob:true};
        updateControlsFromSettings(); loadColors(); draw();
    }
    
    let touchStartDist = 0, touchStartScale = 50, lastTouchPos = {x:0,y:0}, touchStartPos = {x:0,y:0};
    canvas.addEventListener('touchstart', (e) => {
        e.preventDefault();
        if (e.touches.length === 2) {
            const touch1 = e.touches[0], touch2 = e.touches[1];
            touchStartDist = Math.hypot(touch2.clientX - touch1.clientX, touch2.clientY - touch1.clientY);
            touchStartScale = settings.scale;
        } else if (e.touches.length === 1) {
            lastTouchPos = {x: e.touches[0].clientX, y: e.touches[0].clientY};
            touchStartPos = {x: settings.x, y: settings.y};
        }
    }, {passive: false});
    
    canvas.addEventListener('touchmove', (e) => {
        e.preventDefault();
        if (e.touches.length === 2) {
            const touch1 = e.touches[0], touch2 = e.touches[1];
            const currentDist = Math.hypot(touch2.clientX - touch1.clientX, touch2.clientY - touch1.clientY);
            const scale = (currentDist / touchStartDist) * touchStartScale;
            settings.scale = Math.max(10, Math.min(200, scale));
            document.getElementById('scale').value = settings.scale;
            document.getElementById('scaleValue').textContent = settings.scale + '%'; draw();
        } else if (e.touches.length === 1) {
            const deltaX = e.touches[0].clientX - lastTouchPos.x, deltaY = e.touches[0].clientY - lastTouchPos.y;
            settings.x = Math.max(-500, Math.min(500, touchStartPos.x + deltaX * 0.5));
            settings.y = Math.max(-500, Math.min(500, touchStartPos.y + deltaY * 0.5));
            document.getElementById('posX').value = settings.x; document.getElementById('posY').value = settings.y;
            document.getElementById('posXValue').textContent = settings.x; document.getElementById('posYValue').textContent = settings.y; draw();
        }
    }, {passive: false});
    
    window.onload = async function() {
        console.log('ğŸ“± Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚...');
        moveCanvas();
        await loadSettingsFromAPI();
        await loadFrames();
        loadColors();
    };
    
    window.addEventListener('resize', moveCanvas);
</script>
</body>
</html>
