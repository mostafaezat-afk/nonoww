<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 1000px;
            width: 100%;
            margin: 0 auto;
            padding: 40px;
        }

        h1 {
            color: #2d3748;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #667eea;
            margin-bottom: 40px;
            font-size: 1.1em;
        }

        .upload-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .upload-box {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #f8f9fa;
        }

        .upload-box:hover {
            background: #e9ecef;
            border-color: #764ba2;
            transform: translateY(-2px);
        }

        .upload-box.dragover {
            background: #dee2e6;
            border-color: #764ba2;
        }

        .upload-box.uploaded {
            border-color: #28a745;
            background: #d4edda;
        }

        .upload-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .upload-box h3 {
            color: #495057;
            margin-bottom: 10px;
        }

        .upload-box p {
            color: #6c757d;
            font-size: 0.9em;
        }

        input[type="file"] {
            display: none;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1em;
            cursor: pointer;
            transition: transform 0.2s;
            margin: 10px;
            font-weight: 600;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-generate {
            display: block;
            margin: 30px auto;
            font-size: 1.3em;
            padding: 18px 50px;
        }

        #canvas {
            display: none;
        }

        #preview {
            text-align: center;
            margin-top: 30px;
        }

        #previewImg {
            max-width: 500px;
            width: 100%;
            border-radius: 50%;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .buttons {
            text-align: center;
            margin-top: 20px;
        }

        .info {
            background: #e7f3ff;
            border-right: 4px solid #667eea;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            color: #2d3748;
        }

        .info h4 {
            margin-bottom: 10px;
            color: #667eea;
        }

        .info ul {
            margin-right: 20px;
            line-height: 1.8;
        }

        .frame-url-section {
            margin: 30px 0;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px solid #667eea;
        }

        .frame-url-section h3 {
            color: #2d3748;
            margin-bottom: 15px;
            text-align: center;
        }

        .url-input-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .url-input-group input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 1em;
            transition: border 0.3s;
        }

        .url-input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .url-input-group button {
            padding: 12px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .url-input-group button:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        .preview-small {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .preview-item {
            text-align: center;
        }

        .preview-item img {
            max-width: 100%;
            height: 200px;
            object-fit: contain;
            border-radius: 10px;
            border: 2px solid #dee2e6;
            padding: 10px;
            background: white;
        }

        .preview-item p {
            margin-top: 10px;
            color: #6c757d;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .upload-section {
                grid-template-columns: 1fr;
            }
            
            .preview-small {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø¥Ø·Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø®ØµØµØ©</h1>
        <div class="subtitle">Ø§Ø±ÙØ¹ ØµÙˆØ±ØªÙƒ ÙˆØ¥Ø·Ø§Ø±Ùƒ Ø§Ù„Ø®Ø§Øµ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ø­ØªØ±Ø§ÙÙŠ</div>
        
        <div class="frame-url-section">
            <h3>ğŸ”— Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø·Ø§Ø± Ù…Ù† GitHub/URL</h3>
            <div class="url-input-group">
                <input type="text" id="frameUrl" placeholder="https://raw.githubusercontent.com/username/repo/main/frame.png">
                <button onclick="loadFrameFromUrl()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø·Ø§Ø±</button>
            </div>
            <p style="text-align: center; margin-top: 10px; color: #6c757d; font-size: 0.9em;">
                ğŸ’¡ Ø§Ø³ØªØ®Ø¯Ù… Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø± Ù„Ù„ØµÙˆØ±Ø© (ÙŠÙ†ØªÙ‡ÙŠ Ø¨Ù€ .png Ø£Ùˆ .jpg)
            </p>
        </div>

        <div class="upload-section">
            <div class="upload-box" id="userUploadArea">
                <div class="upload-icon">ğŸ‘¤</div>
                <h3>ØµÙˆØ±ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©</h3>
                <p>Ø§Ø¶ØºØ· Ø£Ùˆ Ø§Ø³Ø­Ø¨ ØµÙˆØ±ØªÙƒ Ù‡Ù†Ø§</p>
                <input type="file" id="userFileInput" accept="image/*">
            </div>

            <div class="upload-box" id="frameUploadArea">
                <div class="upload-icon">ğŸ–¼ï¸</div>
                <h3>Ø¥Ø·Ø§Ø± Ø§Ù„ØªØµÙ…ÙŠÙ…</h3>
                <p>Ø§Ø¶ØºØ· Ø£Ùˆ Ø§Ø³Ø­Ø¨ Ø¥Ø·Ø§Ø±Ùƒ Ø§Ù„Ù…Ø®ØµØµ Ù‡Ù†Ø§</p>
                <input type="file" id="frameFileInput" accept="image/*">
            </div>
        </div>

        <div class="preview-small" id="previewSmall"></div>

        <button class="btn btn-generate" id="generateBtn" onclick="generateFinal()" disabled>
            âœ¨ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
        </button>

        <div id="preview"></div>
        
        <canvas id="canvas"></canvas>

        <div class="info">
            <h4>ğŸ“ ÙƒÙŠÙ ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø¯Ø§Ø©:</h4>
            <ul>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 1:</strong> Ø§Ø±ÙØ¹ ØµÙˆØ±ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© (ÙŠÙÙØ¶Ù„ ØµÙˆØ±Ø© ÙˆØ§Ø¶Ø­Ø© Ù„Ù„ÙˆØ¬Ù‡)</li>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 2:</strong> Ø§Ø±ÙØ¹ ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¥Ø·Ø§Ø± Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ (PNG Ø´ÙØ§Ù ÙŠÙÙØ¶Ù„)</li>
                <li><strong>Ø§Ù„Ø®Ø·ÙˆØ© 3:</strong> Ø§Ø¶ØºØ· "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©"</li>
                <li><strong>Ù†ØµÙŠØ­Ø©:</strong> Ø§Ø³ØªØ®Ø¯Ù… Ø¥Ø·Ø§Ø± Ø¨Ø®Ù„ÙÙŠØ© Ø´ÙØ§ÙØ© (PNG) Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ù†ØªÙŠØ¬Ø©</li>
                <li><strong>Ù…Ù‚Ø§Ø³:</strong> Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØ±Ø© Ø¨Ù…Ù‚Ø§Ø³ 1200Ã—1200 Ø¨ÙƒØ³Ù„ (Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§)</li>
            </ul>
        </div>
    </div>

    <script>
        let userImage = null;
        let frameImage = null;

        const userUploadArea = document.getElementById('userUploadArea');
        const frameUploadArea = document.getElementById('frameUploadArea');
        const userFileInput = document.getElementById('userFileInput');
        const frameFileInput = document.getElementById('frameFileInput');
        const generateBtn = document.getElementById('generateBtn');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const preview = document.getElementById('preview');
        const previewSmall = document.getElementById('previewSmall');

        // User image upload
        userUploadArea.addEventListener('click', () => userFileInput.click());
        userFileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                loadUserImage(e.target.files[0]);
            }
        });

        userUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            userUploadArea.classList.add('dragover');
        });

        userUploadArea.addEventListener('dragleave', () => {
            userUploadArea.classList.remove('dragover');
        });

        userUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            userUploadArea.classList.remove('dragover');
            if (e.dataTransfer.files.length > 0) {
                loadUserImage(e.dataTransfer.files[0]);
            }
        });

        // Frame image upload
        frameUploadArea.addEventListener('click', () => frameFileInput.click());
        frameFileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                loadFrameImage(e.target.files[0]);
            }
        });

        frameUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            frameUploadArea.classList.add('dragover');
        });

        frameUploadArea.addEventListener('dragleave', () => {
            frameUploadArea.classList.remove('dragover');
        });

        frameUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            frameUploadArea.classList.remove('dragover');
            if (e.dataTransfer.files.length > 0) {
                loadFrameImage(e.dataTransfer.files[0]);
            }
        });

        function loadUserImage(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    userImage = img;
                    userUploadArea.classList.add('uploaded');
                    userUploadArea.querySelector('.upload-icon').textContent = 'âœ…';
                    updatePreview();
                    checkReady();
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function loadFrameImage(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    frameImage = img;
                    frameUploadArea.classList.add('uploaded');
                    frameUploadArea.querySelector('.upload-icon').textContent = 'âœ…';
                    updatePreview();
                    checkReady();
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function loadFrameFromUrl() {
            const url = document.getElementById('frameUrl').value.trim();
            if (!url) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø·Ø§Ø±');
                return;
            }

            const img = new Image();
            img.crossOrigin = 'anonymous';
            img.onload = () => {
                frameImage = img;
                frameUploadArea.classList.add('uploaded');
                frameUploadArea.querySelector('.upload-icon').textContent = 'âœ…';
                updatePreview();
                checkReady();
                alert('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø·Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­! âœ…');
            };
            img.onerror = () => {
                alert('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØ£Ù†Ù‡ ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ (CORS)');
            };
            img.src = url;
        }

        function updatePreview() {
            if (!userImage && !frameImage) {
                previewSmall.innerHTML = '';
                return;
            }

            let html = '';
            
            if (userImage) {
                html += `
                    <div class="preview-item">
                        <img src="${userImage.src}" alt="ØµÙˆØ±ØªÙƒ">
                        <p>ØµÙˆØ±ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©</p>
                    </div>
                `;
            }
            
            if (frameImage) {
                html += `
                    <div class="preview-item">
                        <img src="${frameImage.src}" alt="Ø§Ù„Ø¥Ø·Ø§Ø±">
                        <p>Ø¥Ø·Ø§Ø± Ø§Ù„ØªØµÙ…ÙŠÙ…</p>
                    </div>
                `;
            }
            
            previewSmall.innerHTML = html;
        }

        function checkReady() {
            if (userImage && frameImage) {
                generateBtn.disabled = false;
            }
        }

        function generateFinal() {
            if (!userImage || !frameImage) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±ØªÙŠÙ† Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }

            const size = 1200;
            canvas.width = size;
            canvas.height = size;

            // Ø±Ø³Ù… ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const scale = Math.max(size / userImage.width, size / userImage.height);
            const imgWidth = userImage.width * scale;
            const imgHeight = userImage.height * scale;
            const imgX = (size - imgWidth) / 2;
            const imgY = (size - imgHeight) / 2;
            
            ctx.drawImage(userImage, imgX, imgY, imgWidth, imgHeight);

            // Ø±Ø³Ù… Ø§Ù„Ø¥Ø·Ø§Ø± ÙÙˆÙ‚ Ø§Ù„ØµÙˆØ±Ø©
            ctx.drawImage(frameImage, 0, 0, size, size);

            displayResult();
        }

        function displayResult() {
            const resultImg = canvas.toDataURL('image/png');
            preview.innerHTML = `
                <img id="previewImg" src="${resultImg}" alt="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©">
                <div class="buttons">
                    <button class="btn" onclick="downloadImage()">ğŸ’¾ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©</button>
                    <button class="btn" onclick="shareImage()">ğŸ“¤ Ù…Ø´Ø§Ø±ÙƒØ©</button>
                    <button class="btn" onclick="reset()">ğŸ”„ Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙŠØ¯</button>
                </div>
            `;
        }

        function downloadImage() {
            const link = document.createElement('a');
            link.download = 'custom-frame-profile.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
        }

        async function shareImage() {
            try {
                const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
                const file = new File([blob], 'custom-frame.png', { type: 'image/png' });
                
                if (navigator.share && navigator.canShare({ files: [file] })) {
                    await navigator.share({
                        files: [file],
                        title: 'ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„Ø®Ø§ØµØ© Ø¨ÙŠ'
                    });
                } else {
                    downloadImage();
                    alert('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ù…Ø´Ø§Ø±ÙƒØªÙ‡Ø§');
                }
            } catch (error) {
                downloadImage();
            }
        }

        function reset() {
            userImage = null;
            frameImage = null;
            preview.innerHTML = '';
            previewSmall.innerHTML = '';
            userFileInput.value = '';
            frameFileInput.value = '';
            userUploadArea.classList.remove('uploaded');
            frameUploadArea.classList.remove('uploaded');
            userUploadArea.querySelector('.upload-icon').textContent = 'ğŸ‘¤';
            frameUploadArea.querySelector('.upload-icon').textContent = 'ğŸ–¼ï¸';
            generateBtn.disabled = true;
            document.getElementById('frameUrl').value = '';
        }
    </script>
</body>
</html>